<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>餐饮店投资计算器</title>
    
    <!-- 引入 React 和 ReactDOM (CDN) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- 引入 Babel 用于解析 JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- 引入 Inter 字体 (让数字更好看) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    
    <!-- 配置 Tailwind 主题 -->
    <script>
        tailwind.config = {
            darkMode: 'media',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'], // 设置默认字体为 Inter
                    },
                    colors: {
                        slate: { 50: '#f8fafc', 100: '#f1f5f9', 200: '#e2e8f0', 300: '#cbd5e1', 400: '#94a3b8', 500: '#64748b', 600: '#475569', 700: '#334155', 800: '#1e293b', 900: '#0f172a' },
                    }
                }
            }
        }
    </script>

    <style>
        /* 全局样式 */
        body {
            background-color: #F2F3F5;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
        }
        @media (prefers-color-scheme: dark) {
            body { background-color: #0B0F19; }
        }

        /* 隐藏输入框的加减箭头 (Spinners) */
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // --- SVG 图标组件 ---
        const CalculatorIcon = ({size=24, className=""}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>
        );
        const HammerIcon = ({size=24, className=""}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m15 12-8.5 8.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L12 9"/><path d="M17.64 15 22 10.64"/><path d="m20.91 11.7-1.25-1.25c-.6-.6-.93-1.4-.93-2.25V7.86c0-.55-.45-1-1-1H14.14c-.83 0-1.64.33-2.25.94L9.5 10.2"/></svg>
        );
        const PieChartIcon = ({size=24, className=""}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></svg>
        );
        const TrendingUpIcon = ({size=24, className=""}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>
        );
        const SparklesIcon = ({size=24, className=""}) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M9 5H5"/><path d="M19 19v4"/><path d="M23 21h-4"/></svg>
        );

        // --- UI 组件 ---

        // 1. 输入框组件
        const InputField = ({ label, value, onChange, required, suffix = "", prefix = "¥", theme = "indigo" }) => {
            const focusColorClasses = {
                orange: "focus-within:border-orange-400 focus-within:shadow-[0_0_0_3px_rgba(251,146,60,0.15)]",
                indigo: "focus-within:border-indigo-400 focus-within:shadow-[0_0_0_3px_rgba(129,140,248,0.15)]",
                emerald: "focus-within:border-emerald-400 focus-within:shadow-[0_0_0_3px_rgba(52,211,153,0.15)]",
            }[theme] || "focus-within:border-slate-400";

            return (
                <div className="flex items-center justify-between py-2 px-1 mb-1">
                    <label className={`text-xs font-bold w-5/12 flex-shrink-0 flex items-center gap-1.5 transition-colors ${required ? 'text-slate-700 dark:text-slate-300' : 'text-slate-400'}`}>
                        {label}
                        {required && (
                            <span className="w-1.5 h-1.5 rounded-full bg-red-500" title="必填"></span>
                        )}
                    </label>

                    <div className="relative w-7/12">
                        <div className={`
                            flex items-center w-full rounded-lg px-3 py-2.5
                            bg-slate-100 dark:bg-white/5 hover:bg-slate-50 dark:hover:bg-white/10
                            border border-transparent transition-all duration-200 ease-out
                            ${focusColorClasses}
                            group cursor-text
                        `}>
                            <span className="text-slate-400 text-xs font-bold mr-2 group-focus-within:text-slate-500 transition-colors select-none">
                                {prefix}
                            </span>
                            
                            <input
                                type="number"
                                min="0"
                                value={value}
                                onChange={(e) => {
                                    const val = e.target.value;
                                    if (val === '' || parseFloat(val) >= 0) {
                                        onChange(val);
                                    }
                                }}
                                onKeyDown={(e) => {
                                    if (["-", "+", "e", "E"].includes(e.key)) {
                                        e.preventDefault();
                                    }
                                }}
                                onWheel={(e) => e.target.blur()}
                                placeholder={required ? "0" : "0"}
                                className={`
                                    w-full bg-transparent text-right font-bold tracking-tight
                                    text-slate-800 dark:text-white placeholder:text-slate-300
                                    focus:outline-none
                                    text-base lg:text-sm font-sans
                                `}
                            />
                            
                            {suffix && (
                                <span className="text-slate-400 text-[10px] font-bold ml-1.5 select-none bg-slate-200/50 dark:bg-white/10 px-1 rounded">
                                    {suffix}
                                </span>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // 2. 结果单元格
        const ResultBox = ({ label, value, subtext, highlightColor = "text-slate-800", isNegativeRed = false, isLast = false, border = true }) => {
            const numValue = typeof value === 'number' ? value : 0;
            
            let finalColorClass = highlightColor;
            if (isNegativeRed) {
                finalColorClass = numValue >= 0 ? 'text-emerald-600 dark:text-emerald-400' : 'text-rose-600 dark:text-rose-400';
            }

            return (
                <div className={`flex flex-col px-3 py-3 lg:px-4 lg:py-4 flex-1 min-w-[85px] justify-center relative ${border && !isLast ? 'border-r border-slate-100 dark:border-white/10' : ''}`}>
                    <span className="text-[10px] text-slate-400 dark:text-slate-500 mb-1 font-bold uppercase tracking-wider truncate">{label}</span>
                    {/* 修改：移除了 font-mono (代码字体)，改用 font-sans (无衬线字体)。
                        添加了 tabular-nums 确保数字等宽对齐。
                        font-extrabold 加粗显示。
                    */}
                    <span className={`text-xl lg:text-2xl font-extrabold leading-none tracking-tight tabular-nums font-sans ${finalColorClass}`}>
                        {numValue.toFixed(2)}
                    </span>
                    {subtext && <span className="text-[9px] text-slate-400/80 dark:text-slate-500/80 mt-1.5 font-medium truncate">{subtext}</span>}
                </div>
            );
        };

        // 3. 模块标题
        const ModuleHeader = ({ icon: Icon, title, bgColor, iconColor }) => (
            <div className="flex items-center gap-3 mb-4 pl-1">
                <div className={`w-9 h-9 rounded-xl flex items-center justify-center shadow-sm transition-transform hover:scale-105 ${bgColor} dark:bg-opacity-20`}>
                    <Icon size={18} className={iconColor} strokeWidth={2.5} />
                </div>
                <h3 className="text-sm font-bold text-slate-800 dark:text-white tracking-wide">{title}</h3>
            </div>
        );

        // 主应用组件
        const InvestmentCalculator = () => {
            const [newStore, setNewStore] = useState({
                rent: '', paymentTerms: '', deposit: '', transferFee: '', franchiseFee: '',
                renovationAds: '', equipment: '', materials: '',
                monthlyLabor: '', utilities: '', grossMargin: ''
            });

            const [existingStore, setExistingStore] = useState({
                dailyRevenue: '', dailyRent: '', dailyLabor: '', dailyUtilities: '', grossMargin: ''
            });

            const parse = (val) => parseFloat(val) || 0;

            // 1. 新开店计算
            const nsRent = parse(newStore.rent);
            const nsTerms = parse(newStore.paymentTerms);
            const nsSetupCost = (nsRent * nsTerms) + parse(newStore.deposit) + parse(newStore.transferFee) + 
                                parse(newStore.franchiseFee) + parse(newStore.renovationAds) + 
                                parse(newStore.equipment) + parse(newStore.materials);
            
            const nsDailyFixed = (nsRent + parse(newStore.monthlyLabor) + parse(newStore.utilities)) / 30;
            const nsMargin = parse(newStore.grossMargin) / 100;
            const nsBreakEven = nsMargin > 0 ? nsDailyFixed / nsMargin : 0;

            // 2. 已开店计算
            const exRevenue = parse(existingStore.dailyRevenue);
            const exMargin = parse(existingStore.grossMargin) / 100;
            const exFixedCost = parse(existingStore.dailyRent) + parse(existingStore.dailyLabor) + parse(existingStore.dailyUtilities);
            const exGrossProfit = exRevenue * exMargin;
            const exNetProfit = exGrossProfit - exFixedCost;
            const exBreakEven = exMargin > 0 ? exFixedCost / exMargin : 0;

            return (
                <div className="min-h-screen bg-[#F2F3F5] dark:bg-[#0B0F19] text-slate-900 dark:text-slate-100 font-sans p-4 lg:p-8 transition-colors duration-300">
                    <div className="max-w-[1600px] mx-auto h-full flex flex-col">
                        
                        {/* Header */}
                        <div className="flex flex-col md:flex-row items-center justify-between mb-8 pb-2 gap-4">
                            <div className="flex items-center gap-4">
                                <div className="p-3 bg-white dark:bg-slate-800 rounded-2xl text-slate-800 dark:text-white shadow-[0_4px_20px_rgba(0,0,0,0.03)] border border-white dark:border-white/10">
                                    <CalculatorIcon size={26} className="stroke-2" />
                                </div>
                                <div>
                                    <h1 className="text-2xl font-black tracking-tighter text-slate-800 dark:text-white font-sans">
                                        餐饮投资计算器
                                    </h1>
                                    <div className="flex items-center gap-2 mt-1">
                                        <p className="text-xs text-slate-500 dark:text-slate-400 font-medium tracking-wide">欢迎使用本工具，祝你生意兴隆</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div className="flex items-center gap-6 text-xs font-bold text-slate-500 dark:text-slate-400 bg-white dark:bg-slate-800 py-3 px-6 rounded-full shadow-[0_8px_20px_rgba(0,0,0,0.02)] border border-white/60 dark:border-white/10">
                                <span className="flex items-center gap-2"><span className="w-2 h-2 rounded-full bg-red-500 shadow-[0_0_6px_rgba(239,68,68,0.4)]"></span> 必填项</span>
                                <span className="w-px h-3 bg-slate-200 dark:bg-slate-700"></span>
                                <span className="flex items-center gap-2"><span className="w-2 h-2 rounded-full bg-indigo-500 shadow-[0_0_6px_rgba(99,102,241,0.4)]"></span> 自动计算</span>
                            </div>
                        </div>

                        {/* 核心布局 */}
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-4 lg:gap-6 items-start">

                            {/* === 模块 1：建店成本 === */}
                            <div className="bg-white dark:bg-[#111623] rounded-[24px] shadow-[0_8px_30px_rgba(0,0,0,0.02)] border border-white dark:border-white/5 flex flex-col h-full overflow-hidden hover:shadow-[0_20px_40px_rgba(0,0,0,0.04)] transition-all duration-300 group">
                                <div className="h-1.5 w-full bg-orange-200 group-hover:bg-orange-300 transition-colors"></div>
                                
                                <div className="p-6 pb-2">
                                    <ModuleHeader icon={HammerIcon} title="新开店：建店成本" bgColor="bg-orange-50" iconColor="text-orange-500" />
                                </div>
                                
                                <div className="px-6 pb-6 flex-1 space-y-1">
                                    <InputField theme="orange" label="房租 (元/月)" value={newStore.rent} onChange={v => setNewStore({...newStore, rent: v})} required />
                                    <InputField theme="orange" label="支付方式 (月)" value={newStore.paymentTerms} onChange={v => setNewStore({...newStore, paymentTerms: v})} suffix="" required prefix="" />
                                    <InputField theme="orange" label="押金" value={newStore.deposit} onChange={v => setNewStore({...newStore, deposit: v})} />
                                    <InputField theme="orange" label="转让费/中介" value={newStore.transferFee} onChange={v => setNewStore({...newStore, transferFee: v})} />
                                    <InputField theme="orange" label="加盟/学习费" value={newStore.franchiseFee} onChange={v => setNewStore({...newStore, franchiseFee: v})} />
                                    <InputField theme="orange" label="装修+广告" value={newStore.renovationAds} onChange={v => setNewStore({...newStore, renovationAds: v})} />
                                    <InputField theme="orange" label="设备费" value={newStore.equipment} onChange={v => setNewStore({...newStore, equipment: v})} />
                                    <InputField theme="orange" label="首批物料" value={newStore.materials} onChange={v => setNewStore({...newStore, materials: v})} />
                                </div>

                                <div className="bg-slate-50 dark:bg-[#0F131F] border-t border-slate-100 dark:border-white/5 flex p-0">
                                    <ResultBox 
                                        label="建店总成本" 
                                        value={nsSetupCost} 
                                        highlightColor="text-orange-600 dark:text-orange-400"
                                        subtext="房租×期数 + 各项杂费"
                                        isLast={true}
                                    />
                                </div>
                            </div>

                            {/* === 模块 2：盈亏平衡 === */}
                            <div className="bg-white dark:bg-[#111623] rounded-[24px] shadow-[0_8px_30px_rgba(0,0,0,0.02)] border border-white dark:border-white/5 flex flex-col h-full overflow-hidden hover:shadow-[0_20px_40px_rgba(0,0,0,0.04)] transition-all duration-300 group">
                                <div className="h-1.5 w-full bg-indigo-200 group-hover:bg-indigo-300 transition-colors"></div>

                                <div className="p-6 pb-2">
                                    <ModuleHeader icon={PieChartIcon} title="新开店：盈亏平衡" bgColor="bg-indigo-50" iconColor="text-indigo-500" />
                                </div>

                                <div className="px-6 pb-6 flex-1 space-y-1">
                                    <InputField theme="indigo" label="每月人工" value={newStore.monthlyLabor} onChange={v => setNewStore({...newStore, monthlyLabor: v})} required />
                                    <InputField theme="indigo" label="水/电/杂费 (月)" value={newStore.utilities} onChange={v => setNewStore({...newStore, utilities: v})} required />
                                    <InputField theme="indigo" label="预估毛利率" value={newStore.grossMargin} onChange={v => setNewStore({...newStore, grossMargin: v})} required prefix="%" suffix="" />
                                    
                                    <div className="mt-8 p-5 rounded-2xl bg-slate-50/80 dark:bg-white/5 border border-slate-100 dark:border-white/10 flex flex-col items-center text-center">
                                        <SparklesIcon size={20} className="text-indigo-400 mb-2" />
                                        <p className="text-xs text-slate-700 dark:text-slate-300 font-bold">
                                            盈亏平衡指标
                                        </p>
                                        <p className="text-[10px] text-slate-400 dark:text-slate-500 mt-1 px-4 leading-relaxed">
                                            此数据帮助您了解店铺每天需要达到多少营业额才能不亏损。
                                        </p>
                                    </div>
                                </div>

                                <div className="bg-slate-50 dark:bg-[#0F131F] border-t border-slate-100 dark:border-white/5 flex divide-x divide-slate-100 dark:divide-white/5">
                                    <ResultBox 
                                        label="每日固定成本" 
                                        value={nsDailyFixed} 
                                        subtext="(房租+人工+杂费)/30"
                                        highlightColor="text-indigo-600 dark:text-indigo-400"
                                    />
                                    <ResultBox 
                                        label="日盈亏平衡点" 
                                        value={nsBreakEven} 
                                        highlightColor="text-indigo-600 dark:text-indigo-400"
                                        subtext="固定成本 ÷ 毛利率"
                                        isLast={true}
                                    />
                                </div>
                            </div>

                            {/* === 模块 3：已开店分析 === */}
                            <div className="bg-white dark:bg-[#111623] rounded-[24px] shadow-[0_8px_30px_rgba(0,0,0,0.02)] border border-white dark:border-white/5 flex flex-col h-full overflow-hidden relative hover:shadow-[0_20px_40px_rgba(0,0,0,0.04)] transition-all duration-300 group">
                                <div className="h-1.5 w-full bg-emerald-200 group-hover:bg-emerald-300 transition-colors"></div>
                                
                                <div className="p-6 pb-2">
                                    <ModuleHeader icon={TrendingUpIcon} title="已开店经营分析" bgColor="bg-emerald-50" iconColor="text-emerald-500" />
                                </div>

                                <div className="px-6 pb-6 flex-1 space-y-1">
                                    <InputField theme="emerald" label="营业额 / 天" value={existingStore.dailyRevenue} onChange={v => setExistingStore({...existingStore, dailyRevenue: v})} required />
                                    <InputField theme="emerald" label="房租 / 天" value={existingStore.dailyRent} onChange={v => setExistingStore({...existingStore, dailyRent: v})} required />
                                    <InputField theme="emerald" label="人工 / 天" value={existingStore.dailyLabor} onChange={v => setExistingStore({...existingStore, dailyLabor: v})} required />
                                    <InputField theme="emerald" label="水/电/杂费 / 天" value={existingStore.dailyUtilities} onChange={v => setExistingStore({...existingStore, dailyUtilities: v})} required />
                                    <InputField theme="emerald" label="实际毛利率" value={existingStore.grossMargin} onChange={v => setExistingStore({...existingStore, grossMargin: v})} required prefix="%" suffix="" />
                                </div>

                                <div className="bg-slate-50 dark:bg-[#0F131F] border-t border-slate-100 dark:border-white/5 mt-auto">
                                    <div className="flex border-b border-slate-100 dark:border-white/5">
                                        <ResultBox 
                                            label="毛利 (每天)" 
                                            value={exGrossProfit} 
                                            isNegativeRed={true}
                                        />
                                        <ResultBox 
                                            label="固定成本 (每天)" 
                                            value={exFixedCost} 
                                            isLast={true}
                                            isNegativeRed={true}
                                        />
                                    </div>
                                    <div className="flex divide-x divide-slate-100 dark:divide-white/5">
                                        <ResultBox 
                                            label="保本线 (每天)" 
                                            value={exBreakEven} 
                                            isNegativeRed={true}
                                            subtext="固定成本 ÷ 毛利率"
                                        />
                                        <ResultBox 
                                            label="净利润 (每天)" 
                                            value={exNetProfit} 
                                            isNegativeRed={true}
                                            subtext="毛利 - 固定成本"
                                            isLast={true}
                                        />
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<InvestmentCalculator />);
    </script>
</body>
</html>
