<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <!-- 视口设置：禁止缩放，适配刘海屏 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>餐饮店投资计算工具</title>
    
    <!-- 网站图标 (Favicon) - 使用计算器 SVG 图标，品牌色 Indigo -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%234F46E5' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect width='16' height='20' x='4' y='2' rx='2'/%3E%3Cline x1='8' x2='16' y1='6' y2='6'/%3E%3Cline x1='16' x2='16' y1='14' y2='18'/%3E%3Cpath d='M16 10h.01'/%3E%3Cpath d='M12 10h.01'/%3E%3Cpath d='M8 10h.01'/%3E%3Cpath d='M12 14h.01'/%3E%3Cpath d='M8 14h.01'/%3E%3Cpath d='M12 18h.01'/%3E%3Cpath d='M8 18h.01'/%3E%3C/svg%3E">
    
    <!-- 引入 React 和 ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- 引入 Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- 引入 Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- 引入 Inter 字体 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'media',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', '-apple-system', 'BlinkMacSystemFont', 'sans-serif'],
                    },
                    colors: {
                        slate: { 50: '#f8fafc', 100: '#f1f5f9', 200: '#e2e8f0', 300: '#cbd5e1', 400: '#94a3b8', 500: '#64748b', 600: '#475569', 700: '#334155', 800: '#1e293b', 900: '#0f172a' },
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #F2F3F5;
            -webkit-tap-highlight-color: transparent;
            -webkit-overflow-scrolling: touch;
        }
        @media (prefers-color-scheme: dark) {
            body { background-color: #0B0F19; }
        }
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; margin: 0; 
        }
        input[type=number] { -moz-appearance: textfield; }
        input { border-radius: 0; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // 图标组件
        const CalculatorIcon = ({size=20, className=""}) => (<svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><rect width="16" height="20" x="4" y="2" rx="2"/><line x1="8" x2="16" y1="6" y2="6"/><line x1="16" x2="16" y1="14" y2="18"/><path d="M16 10h.01"/><path d="M12 10h.01"/><path d="M8 10h.01"/><path d="M12 14h.01"/><path d="M8 14h.01"/><path d="M12 18h.01"/><path d="M8 18h.01"/></svg>);
        const HammerIcon = ({size=18, className=""}) => (<svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m15 12-8.5 8.5c-.83.83-2.17.83-3 0 0 0 0 0 0 0a2.12 2.12 0 0 1 0-3L12 9"/><path d="M17.64 15 22 10.64"/><path d="m20.91 11.7-1.25-1.25c-.6-.6-.93-1.4-.93-2.25V7.86c0-.55-.45-1-1-1H14.14c-.83 0-1.64.33-2.25.94L9.5 10.2"/></svg>);
        const PieChartIcon = ({size=18, className=""}) => (<svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M21.21 15.89A10 10 0 1 1 8 2.83"/><path d="M22 12A10 10 0 0 0 12 2v10z"/></svg>);
        const TrendingUpIcon = ({size=18, className=""}) => (<svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>);

        // 输入框组件 - 紧凑版
        const InputField = ({ label, value, onChange, required, suffix = "", prefix = "¥", theme = "indigo" }) => {
            const focusColorClasses = {
                orange: "focus-within:border-orange-400 focus-within:shadow-[0_0_0_2px_rgba(251,146,60,0.15)]",
                indigo: "focus-within:border-indigo-400 focus-within:shadow-[0_0_0_2px_rgba(129,140,248,0.15)]",
                emerald: "focus-within:border-emerald-400 focus-within:shadow-[0_0_0_2px_rgba(52,211,153,0.15)]",
            }[theme] || "focus-within:border-slate-400";

            return (
                <div className="flex items-center justify-between py-1 px-1 mb-0.5 gap-2">
                    <label className={`text-xs font-bold w-5/12 sm:w-5/12 flex-shrink-0 flex items-center gap-1 transition-colors ${required ? 'text-slate-700 dark:text-slate-300' : 'text-slate-400'} truncate`}>
                        {label}
                        {required && <span className="w-1.5 h-1.5 rounded-full bg-red-500 shrink-0" title="必填"></span>}
                    </label>

                    <div className="relative w-7/12 sm:w-7/12 min-w-0">
                        <div className={`
                            flex items-center w-full rounded-lg px-2 py-1.5 
                            bg-slate-100 dark:bg-white/5 hover:bg-slate-50 dark:hover:bg-white/10
                            border border-transparent transition-all duration-200 ease-out
                            ${focusColorClasses}
                            group cursor-text
                        `}>
                            <span className="text-slate-400 text-[10px] font-bold mr-1 group-focus-within:text-slate-500 transition-colors select-none shrink-0">
                                {prefix}
                            </span>
                            <input
                                type="number" min="0" value={value}
                                onChange={(e) => {
                                    const val = e.target.value;
                                    if (val === '' || parseFloat(val) >= 0) onChange(val);
                                }}
                                onKeyDown={(e) => { if (["-", "+", "e", "E"].includes(e.key)) e.preventDefault(); }}
                                onWheel={(e) => e.target.blur()}
                                placeholder={required ? "0" : "0"}
                                className={`
                                    w-full bg-transparent text-right font-bold tracking-tight
                                    text-slate-800 dark:text-white placeholder:text-slate-300
                                    focus:outline-none text-base lg:text-sm font-sans
                                    min-w-0
                                `}
                            />
                            {suffix && (
                                <span className="text-slate-400 text-[10px] font-bold ml-1 select-none bg-slate-200/50 dark:bg-white/10 px-1 rounded shrink-0">
                                    {suffix}
                                </span>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // 结果单元格 - 紧凑版
        const ResultBox = ({ label, value, subtext, highlightColor = "text-slate-800", isNegativeRed = false, isLast = false, border = true }) => {
            const numValue = typeof value === 'number' ? value : 0;
            let finalColorClass = highlightColor;
            if (isNegativeRed) finalColorClass = numValue >= 0 ? 'text-emerald-600 dark:text-emerald-400' : 'text-rose-600 dark:text-rose-400';

            return (
                <div className={`flex flex-col px-3 py-2 lg:py-3 flex-1 min-w-0 justify-center relative ${border && !isLast ? 'border-r border-slate-100 dark:border-white/10' : ''}`}>
                    <span className="text-[10px] text-slate-400 dark:text-slate-500 mb-0.5 font-bold uppercase tracking-wider truncate">{label}</span>
                    <span className={`text-lg lg:text-xl font-extrabold leading-none tracking-tight tabular-nums font-sans truncate ${finalColorClass}`}>
                        {numValue.toFixed(2)}
                    </span>
                    {subtext && <span className="text-[9px] text-slate-400/80 dark:text-slate-500/80 mt-0.5 font-medium truncate">{subtext}</span>}
                </div>
            );
        };

        const ModuleHeader = ({ icon: Icon, title, bgColor, iconColor }) => (
            <div className="flex items-center gap-2 mb-2 pl-1">
                <div className={`w-7 h-7 rounded-lg flex items-center justify-center shadow-sm transition-transform hover:scale-105 ${bgColor} dark:bg-opacity-20`}>
                    <Icon size={16} className={iconColor} strokeWidth={2.5} />
                </div>
                <h3 className="text-sm font-bold text-slate-800 dark:text-white tracking-wide">{title}</h3>
            </div>
        );

        const InvestmentCalculator = () => {
            const [newStore, setNewStore] = useState({
                rent: '', paymentTerms: '', deposit: '', transferFee: '', franchiseFee: '',
                renovationAds: '', equipment: '', materials: '',
                monthlyLabor: '', utilities: '', grossMargin: ''
            });
            const [existingStore, setExistingStore] = useState({
                dailyRevenue: '', dailyRent: '', dailyLabor: '', dailyUtilities: '', grossMargin: ''
            });

            const parse = (val) => parseFloat(val) || 0;

            const nsRent = parse(newStore.rent);
            const nsTerms = parse(newStore.paymentTerms);
            const nsSetupCost = (nsRent * nsTerms) + parse(newStore.deposit) + parse(newStore.transferFee) + parse(newStore.franchiseFee) + parse(newStore.renovationAds) + parse(newStore.equipment) + parse(newStore.materials);
            const nsDailyFixed = (nsRent + parse(newStore.monthlyLabor) + parse(newStore.utilities)) / 30;
            const nsMargin = parse(newStore.grossMargin) / 100;
            const nsBreakEven = nsMargin > 0 ? nsDailyFixed / nsMargin : 0;

            const exRevenue = parse(existingStore.dailyRevenue);
            const exMargin = parse(existingStore.grossMargin) / 100;
            const exFixedCost = parse(existingStore.dailyRent) + parse(existingStore.dailyLabor) + parse(existingStore.dailyUtilities);
            const exGrossProfit = exRevenue * exMargin;
            const exNetProfit = exGrossProfit - exFixedCost;
            const exBreakEven = exMargin > 0 ? exFixedCost / exMargin : 0;

            return (
                <div className="min-h-screen bg-[#F2F3F5] dark:bg-[#0B0F19] text-slate-900 dark:text-slate-100 font-sans p-2 lg:p-4 transition-colors duration-300 pb-10 flex flex-col items-center">
                    {/* 修改点：max-w 从 1600px 减小到 6xl (约1150px)，让电脑端更紧凑 */}
                    <div className="w-full max-w-6xl mx-auto h-full flex flex-col">
                        
                        {/* Header 更加紧凑 */}
                        <div className="flex flex-col md:flex-row items-center justify-between mb-3 pb-2 gap-2">
                            <div className="flex items-center gap-3">
                                <div className="p-2 bg-white dark:bg-slate-800 rounded-xl text-slate-800 dark:text-white shadow-sm border border-white dark:border-white/10">
                                    <CalculatorIcon size={20} className="stroke-2 text-indigo-600 dark:text-indigo-400" />
                                </div>
                                <h1 className="text-lg font-black tracking-tighter text-slate-800 dark:text-white font-sans">餐饮投资计算器</h1>
                            </div>
                            
                            <div className="hidden md:flex items-center gap-4 text-[10px] font-bold text-slate-500 dark:text-slate-400 bg-white dark:bg-slate-800 py-1.5 px-4 rounded-full shadow-sm border border-white/60 dark:border-white/10">
                                <span className="flex items-center gap-1.5"><span className="w-1.5 h-1.5 rounded-full bg-red-500"></span> 必填</span>
                                <span className="w-px h-3 bg-slate-200 dark:bg-slate-700"></span>
                                <span className="flex items-center gap-1.5"><span className="w-1.5 h-1.5 rounded-full bg-indigo-500"></span> 自动</span>
                            </div>
                        </div>

                        {/* 核心布局: 减小 gap */}
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-3 lg:gap-4 items-start">
                            {/* 模块1 */}
                            <div className="bg-white dark:bg-[#111623] rounded-2xl shadow-sm border border-white dark:border-white/5 flex flex-col h-auto overflow-hidden">
                                <div className="h-1 w-full bg-orange-200"></div>
                                <div className="p-4 pb-1"><ModuleHeader icon={HammerIcon} title="新开店：建店成本" bgColor="bg-orange-50" iconColor="text-orange-500" /></div>
                                <div className="px-4 pb-4 flex-1 space-y-0.5">
                                    <InputField theme="orange" label="房租 (元/月)" value={newStore.rent} onChange={v => setNewStore({...newStore, rent: v})} required />
                                    <InputField theme="orange" label="支付方式 (月)" value={newStore.paymentTerms} onChange={v => setNewStore({...newStore, paymentTerms: v})} suffix="" required prefix="" />
                                    <InputField theme="orange" label="押金" value={newStore.deposit} onChange={v => setNewStore({...newStore, deposit: v})} />
                                    <InputField theme="orange" label="转让费/中介" value={newStore.transferFee} onChange={v => setNewStore({...newStore, transferFee: v})} />
                                    <InputField theme="orange" label="加盟/学习费" value={newStore.franchiseFee} onChange={v => setNewStore({...newStore, franchiseFee: v})} />
                                    <InputField theme="orange" label="装修+广告" value={newStore.renovationAds} onChange={v => setNewStore({...newStore, renovationAds: v})} />
                                    <InputField theme="orange" label="设备费" value={newStore.equipment} onChange={v => setNewStore({...newStore, equipment: v})} />
                                    <InputField theme="orange" label="首批物料" value={newStore.materials} onChange={v => setNewStore({...newStore, materials: v})} />
                                </div>
                                <div className="bg-slate-50 dark:bg-[#0F131F] border-t border-slate-100 dark:border-white/5 flex p-0">
                                    <ResultBox label="建店总成本" value={nsSetupCost} highlightColor="text-orange-600 dark:text-orange-400" subtext="房租×期数 + 各项杂费" isLast={true} />
                                </div>
                            </div>

                            {/* 模块2 */}
                            <div className="bg-white dark:bg-[#111623] rounded-2xl shadow-sm border border-white dark:border-white/5 flex flex-col h-auto overflow-hidden">
                                <div className="h-1 w-full bg-indigo-200"></div>
                                <div className="p-4 pb-1"><ModuleHeader icon={PieChartIcon} title="新开店：盈亏平衡" bgColor="bg-indigo-50" iconColor="text-indigo-500" /></div>
                                <div className="px-4 pb-4 flex-1 space-y-0.5">
                                    <InputField theme="indigo" label="每月人工" value={newStore.monthlyLabor} onChange={v => setNewStore({...newStore, monthlyLabor: v})} required />
                                    <InputField theme="indigo" label="水电杂费(月)" value={newStore.utilities} onChange={v => setNewStore({...newStore, utilities: v})} required />
                                    <InputField theme="indigo" label="预估毛利率" value={newStore.grossMargin} onChange={v => setNewStore({...newStore, grossMargin: v})} required prefix="%" suffix="" />
                                    {/* 移除了中间的装饰性文字块，极大节省空间 */}
                                </div>
                                <div className="bg-slate-50 dark:bg-[#0F131F] border-t border-slate-100 dark:border-white/5 flex">
                                    <ResultBox label="每日固定成本" value={nsDailyFixed} subtext="(房租+人工+杂费)/30" highlightColor="text-indigo-600 dark:text-indigo-400" />
                                    <ResultBox label="日盈亏平衡点" value={nsBreakEven} highlightColor="text-indigo-600 dark:text-indigo-400" subtext="固定成本 ÷ 毛利率" isLast={true} />
                                </div>
                            </div>

                            {/* 模块3 */}
                            <div className="bg-white dark:bg-[#111623] rounded-2xl shadow-sm border border-white dark:border-white/5 flex flex-col h-auto overflow-hidden">
                                <div className="h-1 w-full bg-emerald-200"></div>
                                <div className="p-4 pb-1"><ModuleHeader icon={TrendingUpIcon} title="已开店经营分析" bgColor="bg-emerald-50" iconColor="text-emerald-500" /></div>
                                <div className="px-4 pb-4 flex-1 space-y-0.5">
                                    <InputField theme="emerald" label="营业额 / 天" value={existingStore.dailyRevenue} onChange={v => setExistingStore({...existingStore, dailyRevenue: v})} required />
                                    <InputField theme="emerald" label="房租 / 天" value={existingStore.dailyRent} onChange={v => setExistingStore({...existingStore, dailyRent: v})} required />
                                    <InputField theme="emerald" label="人工 / 天" value={existingStore.dailyLabor} onChange={v => setExistingStore({...existingStore, dailyLabor: v})} required />
                                    <InputField theme="emerald" label="水电杂费 / 天" value={existingStore.dailyUtilities} onChange={v => setExistingStore({...existingStore, dailyUtilities: v})} required />
                                    <InputField theme="emerald" label="实际毛利率" value={existingStore.grossMargin} onChange={v => setExistingStore({...existingStore, grossMargin: v})} required prefix="%" suffix="" />
                                </div>
                                <div className="bg-slate-50 dark:bg-[#0F131F] border-t border-slate-100 dark:border-white/5 mt-auto">
                                    <div className="flex border-b border-slate-100 dark:border-white/5">
                                        <ResultBox label="毛利 (天)" value={exGrossProfit} isNegativeRed={true} />
                                        <ResultBox label="固定成本 (天)" value={exFixedCost} isLast={true} isNegativeRed={true} />
                                    </div>
                                    <div className="flex">
                                        <ResultBox label="保本线 (营业额)" value={exBreakEven} isNegativeRed={true} subtext="固定成本 ÷ 毛利率" />
                                        <ResultBox label="净利润 (天)" value={exNetProfit} isNegativeRed={true} subtext="毛利 - 固定成本" isLast={true} />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<InvestmentCalculator />);
    </script>
</body>
</html>
